I"ì8<h1 id="objective">Objective</h1>
<p>ì•ì—ì„œ êµ¬í˜„í•œ LayerNorm, MultiHeadAttention, GELUë¥¼ ì‚¬ìš©í•˜ê³  ì´ì „ì— êµ¬í˜„í•´ë‘” Linear, Dropout, Softmax í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ Transformer í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ í…ŒìŠ¤íŠ¸í•´ë´…ë‹ˆë‹¤.</p>
<blockquote>
  <p><a href="https://emeraldgoose.github.io/pytorch/transformer-scratch-implementation-1/">Pythonìœ¼ë¡œ Transformer ë°”ë‹¥ë¶€í„° êµ¬í˜„í•˜ê¸°[1] (MultiHead-Attention, LayerNorm, GELU)</a></p>
</blockquote>

<p>ê°€ì¥ ë°”ê¹¥ìª½ì— ìœ„ì¹˜í•œ Transformerë¶€í„° ì‹œì‘í•´ì„œ EncoderLayer, DecoderLayer ìˆœìœ¼ë¡œ ì„¤ëª…í•˜ê³ ì í•©ë‹ˆë‹¤.</p>

<h1 id="transformer">Transformer</h1>
<p>Transformer í´ë˜ìŠ¤ì˜ êµ¬ì¡°ëŠ” TransformerEncoderì™€ TransformerDeocderë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. Transformerë¡œ ë“¤ì–´ì˜¤ëŠ” ì…ë ¥ì€ ì¸ì½”ë”ë¥¼ í†µí•´ ì¸ì½”ë”©ë˜ì–´ ë””ì½”ë”ì˜ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>

<figure style="text-align:center;">
    <a href="https://1drv.ms/i/s!AoC6BbMk0S9Qm07_7PVAiXxoixjr?embed=1&amp;width=798&amp;height=1100" data-lightbox="gallery"><img style="width:70%;" src="https://1drv.ms/i/s!AoC6BbMk0S9Qm07_7PVAiXxoixjr?embed=1&amp;width=798&amp;height=1100" alt="01" /></a>
    <figcaption>Transformer Architecture</figcaption>
</figure>

<h2 id="forward">Forward</h2>
<p>Transformer í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ TransformerEncoderì™€ TransformerDecoderì—ì„œ ì‚¬ìš©í•  encoder_layer, encoder_norm, decoder_layer, decoder_normì„ ì„ ì–¸í•©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/ba48acb781e5437b6585d18d57ecd83e.js"></script>

<h2 id="backward">Backward</h2>
<p>Backwardì—ì„œëŠ” Encoderì™€ Decoderì˜ backward í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ë¦¬í„´ë˜ëŠ” ê¸°ìš¸ê¸°ë“¤ì„ ì €ì¥í•©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/a9b4402ce637590185e56919604d6efe.js"></script>

<h1 id="transformerencoder">TransformerEncoder</h1>
<p>Transformerì˜ EncoderëŠ” EncoderLayerë“¤ì´ ìŠ¤íƒë˜ì–´ ìˆëŠ” êµ¬ì¡°ë¡œ êµ¬í˜„ë©ë‹ˆë‹¤.</p>

<h2 id="forward-1">Forward</h2>
<p>Pytorchì˜ TransformerEncoder í´ë˜ìŠ¤ëŠ” ì¸ì½”ë” ë ˆì´ì–´ë¥¼ <code class="language-plaintext highlighter-rouge">num_layers</code>ë§Œí¼ ë³µì‚¬í•˜ì—¬ ModuleListë¡œ êµ¬ì„±í•©ë‹ˆë‹¤. Transformer í´ë˜ìŠ¤ì—ì„œ ì„ ì–¸ëœ EncoderLayerë¥¼ <code class="language-plaintext highlighter-rouge">_get_clone</code> í•¨ìˆ˜ì—ì„œ <code class="language-plaintext highlighter-rouge">copy.deepcopy()</code>ë¡œ ë³µì‚¬í•˜ê¸° ë•Œë¬¸ì— ìŠ¤íƒë˜ì–´ ìˆëŠ” ì¸ì½”ë” ë ˆì´ì–´ë“¤ì€ ê°™ì€ ì´ˆê¸° íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì§€ê³  ë‹¤ë¥¸ ê¸°ìš¸ê¸°ë¥¼ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/c3997f35f4a3e76a6da5d697109de5ae.js"></script>

<h2 id="backward-1">Backward</h2>
<p>Forwardì—ì„œ ë°˜ë³µë¬¸ì„ í†µí•´ ìˆœì„œëŒ€ë¡œ ê³„ì‚°í•˜ê³  ìˆìœ¼ë¯€ë¡œ ê·¸ ì—­ìˆœìœ¼ë¡œ Backward í•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ ê³„ì‚°í•˜ê³  ê° ë ˆì´ì–´ì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/734b8145dc245a8199e3f3a271081ffe.js"></script>

<h1 id="transformerdecoder">TransformerDecoder</h1>
<p>Transformerì˜ DecoderëŠ” DecoderLayerë“¤ì´ ìŠ¤íƒë˜ì–´ ìˆëŠ” êµ¬ì¡°ë¡œ êµ¬í˜„ë©ë‹ˆë‹¤. ë‹¤ìŒ ê·¸ë¦¼ì˜ ì˜¤ë¥¸ìª½ ì²˜ëŸ¼ DecoderëŠ” Output ì„ë² ë”©ê³¼ ì¸ì½”ë”© ì •ë³´ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ì¶œë ¥ê°’ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>

<h2 id="forward-2">Forward</h2>
<p>forward í•¨ìˆ˜ì˜ argumentë¡œ <code class="language-plaintext highlighter-rouge">tgt</code>ì™€ <code class="language-plaintext highlighter-rouge">memory</code>ê°€ ìˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">tgt</code>ëŠ” output ì„ë² ë”©ì„ ë§í•˜ê³  <code class="language-plaintext highlighter-rouge">memory</code>ëŠ” ì¸ì½”ë” ì¶œë ¥ì„ ë§í•©ë‹ˆë‹¤. Encoder êµ¬í˜„ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ Transformer í´ë˜ìŠ¤ì—ì„œ ì„ ì–¸ëœ DecoderLayerë¥¼ ë³µì‚¬í•˜ì—¬ ModuleListë¡œ êµ¬ì„±í•˜ê³  ë°˜ë³µë¬¸ì„ í†µí•´ í˜¸ì¶œí•˜ì—¬ ê³„ì‚°í•©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/23d416bbbe0732af2d080e7c1aa4f1eb.js"></script>

<h2 id="backward-2">Backward</h2>
<p>Fowardì—ì„œ ë°˜ë³µë¬¸ì„ í†µí•´ ìˆœì„œëŒ€ë¡œ ê³„ì‚°í•˜ê³  ìˆìœ¼ë¯€ë¡œ ê·¸ ì—­ìˆœìœ¼ë¡œ Backward í•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ ê³„ì‚°í•˜ê³  ê° ë ˆì´ì–´ì˜ ê¸°ìš¸ê¸°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/52a3b5ed4af3d7a7bbb7606455d9e39c.js"></script>

<h1 id="transformerencoderlayer">TransformerEncoderLayer</h1>
<p>Transformerì˜ ì¸ì½”ë”©ì„ ë‹´ë‹¹í•˜ëŠ” ë ˆì´ì–´ì…ë‹ˆë‹¤. TransformerEncoderë¡œ ë“¤ì–´ì˜¨ ì…ë ¥ì€ EncoderLayerì˜ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬ë˜ë©° ìµœì¢… ì¶œë ¥ì€ Decoderì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>

<h2 id="forward-3">Forward</h2>
<figure style="text-align:center;">
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQREv7BEX40uQLTR1Sy8KDZXAWUehzE-LH83Rw4WIW0oQm0?width=1024" data-lightbox="gallery" style="width:120%;"><img style="width:70%;" src="https://1drv.ms/i/c/502fd124b305ba80/IQREv7BEX40uQLTR1Sy8KDZXAWUehzE-LH83Rw4WIW0oQm0?width=1024" alt="01" /></a>
    <figcaption>Encoder Layer forward</figcaption>
</figure>

<p>ê³„ì‚° ìˆœì„œëŠ” ë“¤ì–´ì˜¨ ì…ë ¥ì´ ë¨¼ì € MultiheadAttentionì„ ê±°ì¹˜ê³  FeedForward ì—°ì‚°ì„ í†µí•´ ì¸ì½”ë”©ë©ë‹ˆë‹¤. ê° ê²°ê³¼ëŠ” Residual Connection êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì…ë ¥ê³¼ ë”í•´ì¤€ í›„ Layer Normalizationì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
<script src="https://gist.github.com/emeraldgoose/511db6e7427152cf747b55f2982e3570.js"></script></p>

<h2 id="backward-3">Backward</h2>
<figure style="text-align:center;">
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQRVtS1PfLIFTJ0K8RzrSNlwAc9q9HElWPxwrEcgZJQ-LzY?width=1024" data-lightbox="gallery" style="width:120%;"><img style="width:70%;" src="https://1drv.ms/i/c/502fd124b305ba80/IQRVtS1PfLIFTJ0K8RzrSNlwAc9q9HElWPxwrEcgZJQ-LzY?width=1024" alt="01" /></a>
    <figcaption>Encoder Layer backward</figcaption>
</figure>

<p>Backward ì—°ì‚°ì€ Forwardì˜ ì—­ìˆœìœ¼ë¡œ ì§„í–‰ë˜ë©° Forwardì—ì„œ ì‚¬ìš©ëœ Residual Connectionì€ Backwardì—ì„œëŠ” upstream gradientì™€ ë”í•´ì§€ê²Œ ë©ë‹ˆë‹¤.
<script src="https://gist.github.com/emeraldgoose/5ce3f68358a1d4c2b1a0b9151981f1e7.js"></script></p>

<h1 id="transformerdecoderlayer">TransformerDecoderLayer</h1>
<p>Transformerì˜ ë””ì½”ë”©ì„ ë‹´ë‹¹í•˜ëŠ” ë ˆì´ì–´ì…ë‹ˆë‹¤. ì¸ì½”ë”ì˜ ì¶œë ¥ì„ ë””ì½”ë”ì—ì„œ ì‚¬ìš©í•˜ì—¬ output ì‹œí€€ìŠ¤ ì´í›„ì— ë‚˜ì˜¬ í† í°ì„ ì˜ˆì¸¡í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<h2 id="forward-4">Forward</h2>
<figure style="text-align:center;">
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQSOmRpxl0G5RINabXS-mKZIAVyiQITuF0imLAiB-pNmHFM?width=1024" data-lightbox="gallery" style="width:120%;"><img style="width:70%;" src="https://1drv.ms/i/c/502fd124b305ba80/IQSOmRpxl0G5RINabXS-mKZIAVyiQITuF0imLAiB-pNmHFM?width=1024" alt="01" /></a>
    <figcaption>Encoder Layer backward</figcaption>
</figure>
<p>forwardì˜ argumentë¡œ <code class="language-plaintext highlighter-rouge">tgt</code>ì™€ <code class="language-plaintext highlighter-rouge">memory</code>ê°€ ìˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">tgt</code>ëŠ” output ì„ë² ë”© ì…ë ¥ì„ ë‹´ë‹¹í•˜ê³  <code class="language-plaintext highlighter-rouge">memory</code>ëŠ” ì¸ì½”ë”ì˜ ì¶œë ¥ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. EncoderLayerì™€ ë§ˆì°¬ê°€ì§€ë¡œ ê° ë‹¨ê³„ë§ˆë‹¤ Residual Connection êµ¬ì¡°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/d55c7cf1dda2b952a0e3ac3610f2f84d.js"></script>

<h2 id="backward-4">Backward</h2>
<figure style="text-align:center;">
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQSAbNENQ2jXTJqRZ7lQDx60AZf6AFmNJIuMybiJdB0bh60?width=1024" data-lightbox="gallery" style="width:120%;"><img style="width:70%;" src="https://1drv.ms/i/c/502fd124b305ba80/IQSAbNENQ2jXTJqRZ7lQDx60AZf6AFmNJIuMybiJdB0bh60?width=1024" alt="01" /></a>
    <figcaption>Encoder Layer backward</figcaption>
</figure>
<p>Backward ì—°ì‚°ì€ Forwardì˜ ì—­ìˆœìœ¼ë¡œ ì§„í–‰ë˜ë©° Residual Connectionì€ upstream gradientì™€ ë”í•´ì§€ê²Œ ë©ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/be7a478bcd7b067516a81ca37e4d2239.js"></script>

<h1 id="test">Test</h1>
<h2 id="mnist-classification">MNIST Classification</h2>
<p>ì´ì „ í…ŒìŠ¤íŠ¸ì™€ ë§ˆì°¬ê°€ì§€ë¡œ MNIST 5000ì¥ê³¼ í…ŒìŠ¤íŠ¸ 1000ì¥ìœ¼ë¡œ ì‹¤í—˜í–ˆìŠµë‹ˆë‹¤. hidden_sizeëŠ” 32, learning_rateëŠ” 1e-3, 10 epochë¡œ í•™ìŠµì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.</p>

<p>ë‹¤ìŒì€ í•™ìŠµì— ì‚¬ìš©í•œ ëª¨ë¸ì„ ì •ì˜í•œ ì½”ë“œì…ë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/b998ee81096e78ccc7694291df5f242e.js"></script>

<p>MNIST ì´ë¯¸ì§€ì— ìˆœì„œ ì •ë³´ë¥¼ ì£¼ê¸° ìœ„í•´ positional encoding ì •ë³´ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  Transformerì˜ ì¶œë ¥ê°’ì´ (batch_size, 28, embed_size)ì´ë¯€ë¡œ Linear ë ˆì´ì–´ë¡œ í†µê³¼ì‹œí‚¤ê²Œ ë˜ë©´ (batch_size, 28, 10)ì´ ë˜ì–´ë²„ë¦¬ê¸° ë•Œë¬¸ì— Flatten ë ˆì´ì–´ë¥¼ í†µí•´ (batch_size, 28 * embed_size)ë¡œ ë°”ê¿”ì¤€ í›„ Linear ë ˆì´ì–´ë¥¼ í†µí•´ (batch_size, 10) í¬ê¸°ë¥¼ ê°€ì§„ logits ê°’ìœ¼ë¡œ ì¶œë ¥í•˜ë„ë¡ ëª¨ë¸ì„ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.</p>

<p>ì•„ë˜ ê·¸ë˜í”„ë“¤ì€ í•™ìŠµì‹œí‚¨ ê²°ê³¼ì…ë‹ˆë‹¤. ì™¼ìª½ ê·¸ë˜í”„ëŠ” loss, ì˜¤ë¥¸ìª½ ê·¸ë˜í”„ëŠ” accuracyë¥¼ ê¸°ë¡í•œ ê²ƒì…ë‹ˆë‹¤.</p>

<figure class="half">
  <a href="https://1drv.ms/i/s!AoC6BbMk0S9Qm08fTVKlHgRMYqb4?embed=1&amp;width=846&amp;height=833" data-lightbox="gallery"><img src="https://1drv.ms/i/s!AoC6BbMk0S9Qm08fTVKlHgRMYqb4?embed=1&amp;width=846&amp;height=833" alt="02" /></a>
  <a href="https://1drv.ms/i/s!AoC6BbMk0S9Qm03PeZKru6RF6coJ?embed=1&amp;width=841&amp;height=833" data-lightbox="gallery"><img src="https://1drv.ms/i/s!AoC6BbMk0S9Qm03PeZKru6RF6coJ?embed=1&amp;width=841&amp;height=833" alt="03" /></a>
</figure>

<p>hidden sizeê°€ í¬ì§€ ì•Šì•˜ì§€ë§Œ ì˜ í•™ìŠµë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. hidden sizeë¥¼ 256ìœ¼ë¡œ ì˜¬ë¦¬ê³  í•™ìŠµì„ ëŒë ¤ë³´ë©´ accuracyê°€ 0.95 ì´ìƒìœ¼ë¡œ ì˜¬ë¼ê°€ê¸°ë„ í•©ë‹ˆë‹¤.</p>

<h2 id="gpt">GPT</h2>
<p>ë””ì½”ë”ë§Œì„ ì´ìš©í•´ ë‹¤ìŒ í† í°ì„ ì˜ˆì¸¡í•˜ë„ë¡ ëª¨ë¸ì„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/e780545e68eac50bcf2b21000ccdd829.js"></script>

<p>ì‚¬ìš©ëœ íŒŒë¼ë¯¸í„°ì™€ í•™ìŠµ ë¬¸ì¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>embed_size=256, num_heads=4, num_layers=3, learning_rate=1e-4, epochs=50
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sentences = [
    "The quick brown fox jumps over the lazy dog",
    "A journey of a thousand miles begins with a single step",
    "To be or not to be that is the question",
    "All that glitters is not gold but it is very valuable",
    "Knowledge is power but enthusiasm pulls the switch",
    "The only thing we have to fear is fear itself",
    "In the end we will remember not the words of our enemies",
    "Life is what happens when youâ€™re busy making other plans",
    "To succeed in life you need two things ignorance and confidence",
    "The future belongs to those who believe in the beauty of their dreams"
]
</code></pre></div></div>

<p>ë‹¤ìŒ í† í°ì„ ì˜ˆì¸¡í•  ë•ŒëŠ” ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•˜ê¸° ìœ„í•´ logitsì˜ ê°€ì¥ ë†’ì€ í™•ë¥ ì„ ê°€ì§„ í† í°ì„ ì„ íƒí–ˆê³  ë‹¤ìŒì˜ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ start_sequence ì´í›„ì˜ ë¬¸ì¥ì„ ìƒì„±í•´ë´¤ìŠµë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/02072ada41a9bcc83c962c98693ca3f1.js"></script>

<p>ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Input : The
Output: The future belongs to those who believe in the &lt;eos&gt;

Input : The quick
Output : The quick brown &lt;eos&gt;

Input : To
Output: To over over over over over over over over over over over over over over quick over of our of our of our jumps over our enemies &lt;eos&gt;

Input : To be
Output : To be not to be or not to be or not &lt;eos&gt;
</code></pre></div></div>

<p>Outputì„ ë³´ë©´ í•™ìŠµ ë¬¸ì¥ê³¼ ê´€ë ¨ìˆëŠ” í† í°ì„ ìƒì„±í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹œì‘ ë¬¸ì¥ì´ â€œToâ€ì¸ ê²½ìš° overëŠ” ê´€ë ¨ì´ ì—†ì§€ë§Œ ê·¸ ì´í›„ ë“±ì¥í•˜ëŠ” í† í°ë“¤ì´ sentencesì˜ ì²« ë²ˆì§¸ ë¬¸ì¥ê³¼ ê´€ë ¨ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì—¬ëŸ¬ë²ˆ ìƒì„±í•  ë•Œë§ˆë‹¤ ë‹¤ë¥¸ ë¬¸ì¥ë“¤ì´ ë“±ì¥í•˜ëŠ” ëœë¤ì„±ê³¼ Transformer ëª¨ë¸ íŠ¹ì§•ë‹µê²Œ í† í°ì´ ë°˜ë³µì ìœ¼ë¡œ ë“±ì¥í•˜ëŠ” ë¬¸ì œë„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê²°ê³¼ë¥¼ í†µí•´ LLMì´ ìƒì„±í•˜ëŠ” í† í°ì„ ì„ íƒí•˜ëŠ” ì „ëµì´ í•„ìš”í•¨ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="bert">BERT</h2>
<p>ì¸ì½”ë”ë§Œì„ ì´ìš©í•´ [MASK]í† í°ì„ ì˜ˆì¸¡í•˜ë„ë¡ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì‚¬ìš©ëœ íŒŒë¼ë¯¸í„°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>embed_size=128, num_heads=8, num_layers=2, learning_rate=1e-3, epochs=100
</code></pre></div></div>
<script src="https://gist.github.com/emeraldgoose/0309e135c7e6235a0798ffd9d01e794b.js"></script>

<p>í•™ìŠµê³¼ì •ì€ MLM(Masked Language Model) íƒœìŠ¤í¬ë§Œ ìˆ˜í–‰í•˜ê³  ë¬¸ì¥ë§ˆë‹¤ ëœë¤í•˜ê²Œ 30%ì˜ ë§ˆìŠ¤í‚¹ì„ í•˜ì—¬ ì˜ˆì¸¡í•˜ë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/e3a7a8c2285066e62c116b1d211e09b3.js"></script>

<p>í† í°ì„ ì˜ˆì¸¡í•  ë•ŒëŠ” logitsì˜ ê°€ì¥ ë†’ì€ í™•ë¥ ì„ ê°€ì§„ í† í°ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.</p>

<script src="https://gist.github.com/emeraldgoose/c67f7fe6ff72e87faadb594ec8970ce7.js"></script>

<p>ë§ˆìŠ¤í‚¹ëœ í† í°ì„ ì˜ˆì¸¡í•˜ê³  ì–´ë–¤ í† í°ì´ top-5ì— ì†í•˜ëŠ”ì§€ í™•ì¸í•´ë³´ê³  ì‹¶ì–´ ì´ë ‡ê²Œ ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p>

<p>ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Orignal: Great minds think alike, but they also think differently

Input: Great minds [MASK] alike, but they also think differently

Output: &lt;sos&gt; Great minds think alike, but they also think differently &lt;pad&gt; &lt;pad&gt; &lt;pad&gt; &lt;pad&gt; &lt;pad&gt; &lt;pad&gt; &lt;eos&gt;

Token(Prob): think(0.31) | alike,(0.08) | best(0.05) | differently(0.02) | but(0.02)
</code></pre></div></div>
<p>ì‹ ê¸°í•˜ê²Œ [MASK] í† í° ìœ„ì¹˜ì— ë“¤ì–´ê°ˆ í† í° í›„ë³´ë“¤ì´ ì£¼ë¡œ í•™ìŠµí•œ ë¬¸ì¥ ë‚´ì—ì„œ ë‚˜ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<blockquote>
  <p>GPTì™€ BERT ì‹¤í—˜ ì½”ë“œëŠ” ì•„ë˜ simple_gpt.ipynbì— ì‘ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>

<h1 id="code">Code</h1>
<ul>
  <li><a href="https://github.com/emeraldgoose/hcrot">https://github.com/emeraldgoose/hcrot</a></li>
  <li><a href="https://github.com/emeraldgoose/hcrot/blob/master/simple_gpt.ipynb">https://github.com/emeraldgoose/hcrot/blob/master/simple_gpt.ipynb</a></li>
</ul>
:ET