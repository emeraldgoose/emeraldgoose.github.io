I"<p>AI 관련 CTF가 있는 줄은 몰랐는데 Kaggle에서 해당 대회가 열려 한번 참가하여 한 달간 풀어봤습니다. 대회에서 사용되는 Capture the Flag(CTF) 방식은 취약점을 통해 주최자가 숨겨둔 플래그를 찾아 문제를 해결할 수 있습니다. 이 대회는 27개의 문제로 이루어졌고 테스트 문제 한 개를 제외한 26문제에 각각 혼자서 도전하게 됩니다. 풀어본 문제 중에 일부분의 문제를 리뷰해보려고 합니다.</p>

<h2 id="cluster---level-2">Cluster - Level 2</h2>
<p>넘파이 데이터를 불러오면 문자 하나씩 들어있는 tokens와 벡터로 구성된 points 속성을 확인할 수 있습니다. points가 벡터 형식이므로 다음의 코드로 클러스터링을 시도해볼 수 있습니다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="n">ks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">inertias</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">ks</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'points'</span><span class="p">])</span>
    <span class="n">inertias</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">inertia_</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">inertias</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="n">ks</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>위 코드를 실행하면 다음의 그래프를 얻을 수 있습니다.
<img src="https://drive.google.com/uc?export=view&amp;id=1t_ZPO_5L3URk8lEn_o1tOHZx6X0sxK4D" alt="" width="500" /></p>

<p>KMeans 모델의 이너셔(inertia)는 클러스터 중심과 클러스터에 속한 샘플간의 거리의 제곱의 합을 말합니다. 이너셔는 클러스터 개수가 늘어나면 당연히 거리가 줄어들기 때문에 이너셔도 같이 줄어드는데 클러스터 개수를 늘릴 때 기울기를 확인하면 최적의 K값을 찾을 수 있습니다.</p>

<p>위 그래프를 보면 x값 4까지는 기울기가 크지만 4이후 기울기가 크게 감소합니다. 따라서 K값을 4로 두었을 때 최적의 클러스터를 형성함을 알 수 있고 정답 4을 제출하면 플래그를 얻을 수 있습니다.</p>

<h2 id="cluster---level-3">Cluster - Level 3</h2>

<p>##</p>
:ET