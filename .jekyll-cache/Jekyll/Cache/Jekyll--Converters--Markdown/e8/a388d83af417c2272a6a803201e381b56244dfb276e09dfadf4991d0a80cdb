I"¾ˆ<h2 id="rag">RAG</h2>
<p>RAG (Retrieval Augmented Generation)ë€, LLMì´ í•™ìŠµí•œ ë°ì´í„°ë¡œë¶€í„° ë‹µë³€í•˜ì§€ ì•Šê³  ì™¸ë¶€ ë¬¸ì„œ(Context)ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì‹œìŠ¤í…œì„ ë§í•©ë‹ˆë‹¤. RAGëŠ” LLMì´ ìì‹ ì´ í•™ìŠµí•œ ë°ì´í„°ê°€ ì•„ë‹Œ ì™¸ë¶€ì˜ ìµœì‹  ì •ë³´ë¥¼ ì°¸ì¡°í•˜ì—¬ ë‹µë³€ì˜ ë¶€ì •í™•ì„±ì´ë‚˜ í™˜ê°(Hallucination)ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="retriever">Retriever</h2>
<p>RetrieverëŠ” ìœ ì €ì˜ ì§ˆë¬¸ì— ê´€ë ¨ì´ ë†’ì€ ë¬¸ì„œë¥¼ ê°€ì ¸ì˜¤ëŠ” ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” êµ¬ì„±ìš”ì†Œì…ë‹ˆë‹¤. ê´€ë ¨ ë¬¸ì„œë¥¼ ê°€ì ¸ì˜¤ëŠ” ì „ëµìœ¼ë¡œëŠ” BM25, Bi-Encoder ë“±ì˜ ë°©ì‹ì´ ìˆìŠµë‹ˆë‹¤.</p>

<h3 id="lexical-search-bm25">Lexical Search: BM25</h3>
<p>BM25ëŠ” í‚¤ì›Œë“œ ë§¤ì¹­ì„ í†µí•´ ì ìˆ˜ë¥¼ ë‚´ëŠ” ë°©ì‹ì„ ë§í•©ë‹ˆë‹¤. TF-IDFë¥¼ í™œìš©í•´ ì§ˆì˜ì™€ ë¬¸ì„œê°„ì˜ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ì—¬ ë¹ ë¥´ê³  ê°„ë‹¨í•œ ì§ˆë¬¸ì— ì í•©í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ì§ˆì˜ì˜ ë¬¸ë§¥ì„ ì´ìš©í•˜ì§€ ëª»í•´ ê´€ë ¨ëœ ë¬¸ì„œê°€ ê²€ìƒ‰ë˜ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤.</p>

<h3 id="semantic-search-bi-encoder">Semantic Search: Bi-Encoder</h3>
<p>Bi-EncoderëŠ” ì§ˆì˜ì™€ ë¬¸ì„œê°„ì˜ ì„ë² ë”© ë²¡í„° ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ì—¬ ì ìˆ˜ë¥¼ ë‚´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. BERTì™€ ê°™ì€ ì–¸ì–´ëª¨ë¸ì„ ì´ìš©í•´ ë¬¸ë§¥ì  ì˜ë¯¸ê°€ ë‹´ê¸´ ì„ë² ë”© ë²¡í„°ë¥¼ ìƒì„±í•˜ì—¬ ì§ˆì˜ì™€ ë¬¸ì„œì˜ ì˜ë¯¸ì ì¸ ìœ ì‚¬ì„±ì„ ì˜ ì°¾ì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¯¸ë¦¬ ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥í•  ìˆ˜ ìˆì–´ ê²€ìƒ‰ ì‹œ ìœ ì‚¬ë„ë§Œ ê³„ì‚°í•˜ë©´ ë˜ë¯€ë¡œ í¬ê²Œ ëŠë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì§ˆì˜ë‚˜ ë¬¸ì„œê°€ ê¸¸ì–´ì§ˆìˆ˜ë¡ ë²¡í„°ë¡œ í‘œí˜„í•  ë•Œ ì •ë³´ê°€ ì†ì‹¤ë  ìˆ˜ ìˆê³  Queryì™€ Candidatesê°„ì˜ ê´€ê³„ì„±ì„ ê³ ë ¤í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— Cross-Encoder ëŒ€ë¹„ ì •í™•ë„ê°€ ë–¨ì–´ì§‘ë‹ˆë‹¤.</p>

<h3 id="hybrid-search-lexical-search--semantic-search">Hybrid Search: Lexical Search + Semantic Search</h3>
<p>Hybrid SearchëŠ” ìœ ì € ì§ˆì˜ì˜ í‚¤ì›Œë“œë¥¼ ì¤‘ì ìœ¼ë¡œ ì°¾ëŠ” BM25ì™€ ìœ ì € ì§ˆì˜ì™€ ì˜ë¯¸ì ìœ¼ë¡œ ìœ ì‚¬í•œ ë¬¸ì„œë¥¼ ì°¾ëŠ” Bi-Encoderë¥¼ ê°™ì´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ë§í•©ë‹ˆë‹¤. Hybrid Searchì˜ ê²€ìƒ‰ ê²°ê³¼ëŠ” Lexcial Search í˜¹ì€ Semantic Searchë¥¼ ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©í•œ ê²°ê³¼ë³´ë‹¤ ì •í™•í•œ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²€ìƒ‰ ê²°ê³¼ì— ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ë©´ ë„ë©”ì¸ íŠ¹ì„±ì— ë”°ë¼ ìµœì í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³´í†µ ìì£¼ ì‚¬ìš©í•˜ëŠ” ê³„ì‚°ë°©ì‹ìœ¼ë¡œëŠ” CC(Convex Combination)ê³¼ RRF(Reciprocal Rank Fusion)ì´ ìˆìŠµë‹ˆë‹¤.</p>

<p><strong>Convex Combination</strong></p>
<ul>
  <li>$score(doc) = \alpha * score_{lex}(doc) + \beta * score_{sem}(doc)$</li>
</ul>

<p>CCëŠ” alphaì™€ betaì„ ê°ê° ìŠ¤ì½”ì–´ì— ê³±í•´ ìµœì¢… ìŠ¤ì½”ì–´ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ë‘ ìŠ¤ì½”ì–´ ê°’ì„ í•©ì¹˜ê¸° ìœ„í•´ ê° ìŠ¤ì½”ì–´ë§ˆë‹¤ Normalization ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>

<p><strong>Reciprocal Rank Fusion</strong></p>
<ul>
  <li>$score(doc) = \frac{1}{k + rank_{lex}(doc)} + \frac{1}{k + rank_{sem}(doc)}$</li>
</ul>

<p>RRFëŠ” ê°€ì¤‘ì¹˜ê°€ ì•„ë‹Œ ë¬¸ì„œì˜ ìˆœìœ„ë¥¼ ì´ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ê°€ì¤‘ì¹˜ë¥¼ ì´ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— Normalization ê³¼ì •ì´ í•„ìš”í•˜ì§€ ì•Šê³  ìˆœìœ„ê°€ ë‚®ì€ ë¬¸ì„œë¥¼ ìœ„í•´ ì¡°ì •í•˜ëŠ” ì„ì˜ì˜ ê°’ì…ë‹ˆë‹¤.</p>

<h3 id="cross-encoder">Cross-Encoder</h3>
<p>Cross-EncoderëŠ” í•˜ë‚˜ì˜ ì–¸ì–´ëª¨ë¸ì— Queryì™€ Candidateë¥¼ ê°™ì´ ë„£ì–´ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. Bi-Encoder ëŒ€ë¹„ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ê´œì°®ì§€ë§Œ Cross-Encoderë¥¼ Retreiverë¡œ ì‚¬ìš©í•œë‹¤ë©´ ë§¤ ì§ˆì˜ë§ˆë‹¤ ëª¨ë“  ë¬¸ì„œì™€ì˜ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.</p>

<h3 id="reranking-ì „ëµ">Reranking ì „ëµ</h3>
<p>Reranking ì „ëµì€ ì ì ˆí•œ ë¬¸ì„œ í›„ë³´êµ°ì„ ì„ ë³„í•˜ê³  Cross-Encoderë¡œ ìˆœìœ„ë¥¼ ì¬ì¡°ì •í•˜ëŠ” ì „ëµì„ ë§í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ êµ¬ì„±í•˜ë©´, Cross-Encoderë§Œ ì‚¬ìš©í–ˆì„ ë•Œë³´ë‹¤ ê³„ì‚° ë¹„ìš©ì´ ì¤„ê³  ì •í™•ë„ë¥¼ í™•ë³´í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>

<figure>
    <img src="https://framerusercontent.com/images/4atMCrE67i6XDQdSySevR8sVhM.png" />
    <figcaption>https://dify.ai/blog/hybrid-search-rerank-rag-improvement</figcaption>
</figure>

<p>ê·¸ë ‡ë‹¤ë©´ RAG ì‹œìŠ¤í…œì—ì„œ Reranking ì „ëµì´ ì™œ í•„ìš”í•œì§€ ìƒê°í•´ë³¼ ìˆ˜ ìˆëŠ”ë° LLMì˜ ë‹µë³€ ì •í™•ë„ê°€ Contextì˜ ìˆœì„œì™€ ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
<a href="https://arxiv.org/abs/2307.03172">Lost in the Middle: How Language Models Use Long Contexts</a> ë…¼ë¬¸ì—ëŠ” ì •ë‹µê³¼ ê´€ë ¨ëœ ë¬¸ì„œê°€ ê°€ìš´ë° ìœ„ì¹˜í•  ìˆ˜ë¡ ë‹µë³€ ì„±ëŠ¥ì´ ë–¨ì–´ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì´ëŸ¬í•œ ì´ìœ  ë•Œë¬¸ì— RAG ì‹œìŠ¤í…œì—ì„œ Hybrid Searchì˜ ë¬¸ì„œ ìˆœìœ„ë¥¼ ì¬ì¡°ì •í•˜ëŠ” Reranking ì „ëµì´ í•„ìš”í•¨ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="rag-êµ¬í˜„">RAG êµ¬í˜„</h2>
<h3 id="pipeline">Pipeline</h3>
<figure style="text-align:center;">
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQTHCBiTNjXJSrDfn8ZtMHRJAXPh5Xy2ex78zUYezRLVn8s?width=1024" onclick="return false;" data-lightbox="gallery">
        <img src="https://1drv.ms/i/c/502fd124b305ba80/IQTHCBiTNjXJSrDfn8ZtMHRJAXPh5Xy2ex78zUYezRLVn8s?width=1024" alt="01" style="max-width: 80%; height: auto;" />
    </a>
</figure>

<p>RAG íŒŒì´í”„ë¼ì¸ ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<ol>
  <li>ìœ ì €ê°€ ì§ˆë¬¸ì„ ë³´ë‚´ë©´ <code class="language-plaintext highlighter-rouge">text-embedding-004</code> ëª¨ë¸ë¡œë¶€í„° ì„ë² ë”© ë²¡í„°ë¥¼ ë°›ìŠµë‹ˆë‹¤.</li>
  <li>ìœ ì € ì¿¼ë¦¬ì™€ ì„ë² ë”© ë²¡í„°ë¥¼ ì´ìš©í•´ Vector Storeì¸ <code class="language-plaintext highlighter-rouge">Opensearch</code>ì— Hybrid Searchë¡œ í›„ë³´ ë¬¸ì„œë“¤ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.</li>
  <li>í›„ë³´ ë¬¸ì„œë“¤ì„ Opensearch ML ê¸°ëŠ¥ì„ ì´ìš©í•´ Rerankingí•©ë‹ˆë‹¤.</li>
  <li>ìµœì¢… Contextì™€ ìœ ì € ì§ˆì˜ë¥¼ LLM(<code class="language-plaintext highlighter-rouge">Gemini-2.0-flash</code>)ì— ì „ë‹¬í•´ ë‹µë³€ì„ ë°›ì•„ì˜µë‹ˆë‹¤.</li>
  <li>LLMì˜ ë‹µë³€ì„ ìœ ì €ì—ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.</li>
</ol>

<h3 id="opensearch">Opensearch</h3>
<p>Vector Storeë¡œ Opensearchë¥¼ ì„ íƒí–ˆëŠ”ë° ê·¸ ì´ìœ ëŠ” lexical searchì™€ semantic search ëª¨ë‘ ì§€ì›í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. Semantic searchëŠ” knn(K-Nearest Neighbor) ì•Œê³ ë¦¬ì¦˜ì„ ì§€ì›í•˜ê³  ìˆì–´ ë¹ ë¥¸ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°›ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, Opensearch í´ëŸ¬ìŠ¤í„°ì— MLëª¨ë¸ì„ ë°°í¬í•˜ê³  REST APIë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ ìˆì–´ ì´ë¥¼ ì´ìš©í•´ Reranking ì „ëµì„ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>

<h3 id="gemini">Gemini</h3>
<p>LLMì€ Googleì˜ Gemini ëª¨ë¸ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” 1Mì˜ í† í° ì»¨í…ìŠ¤íŠ¸ë¥¼ ì§€ì›í•˜ê³  ìˆì–´ í”„ë¡¬í”„íŠ¸ì— ì¶©ë¶„íˆ ë§ì€ Contextë“¤ì„ ë„£ì„ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>

<blockquote>
  <p>Gemini 2.0 Flashì˜ ë¬´ë£Œ ë“±ê¸‰ì€ ì‹œê°„ë‹¹ 1ë°±ë§Œê°œì˜ í† í° ì œí•œì´ ê±¸ë ¤ìˆìŠµë‹ˆë‹¤. ì œí’ˆ ê°œì„ ì— ì‚¬ìš© ë‚´ì—­ì´ ì‚¬ìš©ë˜ê¸°ëŠ” í•˜ì§€ë§Œ í† ì´ í”„ë¡œì íŠ¸ë¡œ ì‚¬ìš©í•˜ê¸°ì— ì¶©ë¶„í•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.</p>
</blockquote>

<h3 id="demo-app">Demo APP</h3>
<p>ë§ì´ ì‚¬ìš©í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì¸ Streamlitì„ ì‚¬ìš©í•´ì„œ ì•ë‹¨ì„ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.</p>
<figure>
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQRhkcrRacG5QoIRDWhpuPswAUx8mqDtVT69w05eslUP6sI?width=2828&amp;height=1342" onclick="return false;" data-lightbox="gallery">
        <img src="https://1drv.ms/i/c/502fd124b305ba80/IQRhkcrRacG5QoIRDWhpuPswAUx8mqDtVT69w05eslUP6sI?width=2828&amp;height=1342" alt="02" style="max-width: 100%; height: auto'" />
    </a>
    <figcaption>Frontend</figcaption>
</figure>

<p>ì‚¬ìš©ìê°€ PDFíŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ íŒŒì‹± í›„ Vector Storeì— ë¬¸ì„œë¥¼ ì ì¬í•˜ê³  ì•„ë˜ ì¡°ê±´ì— ë”°ë¼ ìœ ì € ì§ˆì˜ì— ë”°ë¼ ë¬¸ì„œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.</p>

<h3 id="pdf-parse">PDF Parse</h3>
<p>PDF ë¬¸ì„œ ë‚´ì—ì„œ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ í•˜ë‚˜ì¸ Unstructuredë¥¼ ì´ìš©í–ˆìŠµë‹ˆë‹¤. í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ê³  ìˆê³  Langchainê³¼ ì—°ë™ì´ ë˜ì–´ ìˆì–´ ì‰½ê²Œ ì‚¬ìš©ê°€ëŠ¥í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, PDFì˜ í‘œë¥¼ ì¶”ì¶œí•˜ëŠ” ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>

<p><strong>Llamaindex</strong><br />
PDF ë¬¸ì„œë¥¼ Unstructured ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë°”ë¡œ íŒŒì‹±í•˜ëŠ” ê²½ìš°, í…Œì´ë¸” í˜•ì‹ì´ ì œëŒ€ë„ íŒŒì‹±ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì¤‘ê°„ ë³€í™˜ ê³¼ì •ì´ í•„ìš”í–ˆê³  ë§ˆí¬ë‹¤ìš´ê³¼ ì´ë¯¸ì§€ í˜•ì‹ ë‘ ê°€ì§€ë¥¼ ê³ ë ¤í–ˆìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ ë³€í™˜ ë°©ì‹ë„ LLMì´ ì´ë¯¸ì§€ë„ ì˜ í•´ì„í•´ì£¼ê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•œ ë°©ë²•ì´ì§€ë§Œ ê·¸ ë§Œí¼ ë¹„ìš©ì´ ë“¤ì–´ê°€ê¸° ë•Œë¬¸ì— ë§ˆí¬ë‹¤ìš´ ë³€í™˜ì„ ì„ íƒí•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ë§ˆí¬ë‹¤ìš´ ë³€í™˜ì„ ì´ìš©í•  ë•ŒëŠ” <a href="https://www.llamaindex.ai/">Llamaindex</a>ë¼ëŠ” ìƒìš© ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í–ˆê³  ê´œì°®ì€ ê²°ê³¼ë¬¼ì„ ë°˜í™˜í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.</p>

<blockquote>
  <p>Llamaindexì˜ Free Planì€ í•˜ë£¨ì— 1000í˜ì´ì§€ ë³€í™˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ ì •ë„ë©´ í† ì´ í”„ë¡œì íŠ¸ë¡œ ì‚¬ìš©í•  ë•Œ ì¶©ë¶„í•˜ë‹¤ê³  ìƒê°ë©ë‹ˆë‹¤.</p>
</blockquote>

<blockquote>
  <p>Llamaindex ë§ê³ ë„ Upstageì—ì„œë„ <a href="https://www.upstage.ai/blog/en/let-llms-read-your-documents-with-speed-and-accuracy">Document Parse</a> ì„œë¹„ìŠ¤ë¥¼ ì œê³µì¤‘ì— ìˆìŠµë‹ˆë‹¤.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">llama_cloud_services</span> <span class="kn">import</span> <span class="n">LlamaParse</span>

<span class="n">llamaparse</span> <span class="o">=</span> <span class="n">LlamaParse</span><span class="p">(</span>
        <span class="n">result_type</span><span class="o">=</span><span class="s">"markdown"</span><span class="p">,</span>
        <span class="n">api_key</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'LLAMA_CLOUD_API_KEY'</span><span class="p">)</span>
    <span class="p">).</span><span class="n">load_data</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Unstructured.io</strong><br />
Llamaindexë¡œ ë³€í™”ëœ ë§ˆí¬ë‹¤ìš´ë“¤ë¡œë¶€í„° ì •ë³´ë¥¼ ì¶”ì¶œí•´ì•¼ í•©ë‹ˆë‹¤. Langchainì—ì„œ ì œê³µí•˜ëŠ” UnstructuredMarkdownLoaderë¥¼ ì´ìš©í•´ ë¬¸ì„œë¥¼ íŒŒì‹±í•˜ê³  Vector Storeì— ì €ì¥í•  ì¤€ë¹„ë¥¼ í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">langchain_community.document_loaders</span> <span class="kn">import</span> <span class="n">UnstructuredMarkdownLoader</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">UnstructuredMarkdownLoader</span><span class="p">(</span>
        <span class="n">file_path</span><span class="o">=</span><span class="n">markdown_path</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s">"elements"</span><span class="p">,</span>
        <span class="n">chunking_strategy</span><span class="o">=</span><span class="s">"by_title"</span><span class="p">,</span>
        <span class="n">strategy</span><span class="o">=</span><span class="s">"hi_res"</span><span class="p">,</span>
        <span class="n">max_characters</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
        <span class="n">new_after_n_chars</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>
        <span class="n">combine_text_under_n_chars</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">docs</span> <span class="o">=</span> <span class="n">loader</span><span class="p">.</span><span class="n">load</span><span class="p">()</span>
</code></pre></div></div>
<p>ì—¬ê¸°ì„œ ì¶”ì¶œëœ í…Œì´ë¸”ì€ ë²¡í„° ìŠ¤í† ì–´ì—ì„œ ê²€ìƒ‰í•  ë•Œ ì¢‹ì§€ ëª»í•˜ë¯€ë¡œ LLMì„ ì´ìš©í•´ í…Œì´ë¸” ë‚´ìš©ì„ ìš”ì•½í•˜ë„ë¡ í•˜ê³  ìš”ì•½ëœ ì„¤ëª…ì„ ê²€ìƒ‰ì— í™œìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤.</p>

<p><strong>OpenSearchVectorSearch</strong><br />
Langchainì—ì„œ Opensearchë¥¼ ë²¡í„° ìŠ¤í† ì–´ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„ì²´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ docsë¥¼ ì‰½ê²Œ Opensearchì— ì ì¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. OpenSearchVectorSearchì˜ embedding_functionì—ëŠ” embedding ëª¨ë¸ì„ ë„£ì–´ Semantic searchë¥¼ ìœ„í•´ ë¬¸ì„œì˜ ì„ë² ë”© ë²¡í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.</p>

<p>ë‹¨, Opensearchì— ë¬¸ì„œë“¤ì„ ì ì¬í•˜ê¸° ì „ì— ë°˜ë“œì‹œ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">langchain_google_genai</span> <span class="kn">import</span> <span class="n">GoogleGenerativeAIEmbeddings</span>
<span class="kn">from</span> <span class="nn">langchain_community.vectorstores</span> <span class="kn">import</span> <span class="n">OpenSearchVectorSearch</span>

<span class="n">llm_emb</span> <span class="o">=</span> <span class="n">GoogleGenerativeAIEmbeddings</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="s">'models/text-embedding-004'</span><span class="p">,</span>
        <span class="n">google_api_key</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'GOOGLE_API_KEY'</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">vector_db</span> <span class="o">=</span> <span class="n">OpenSearchVectorSearch</span><span class="p">(</span>
        <span class="n">index_name</span><span class="o">=</span><span class="n">index_name</span><span class="p">,</span>
        <span class="n">opensearch_url</span><span class="o">=</span><span class="n">opensearch_url</span><span class="p">,</span>
        <span class="n">embedding_function</span><span class="o">=</span><span class="n">llm_emb</span><span class="p">,</span>
        <span class="n">http_auth</span><span class="o">=</span><span class="p">(</span><span class="n">opensearch_id</span><span class="p">,</span> <span class="n">opensearch_password</span><span class="p">),</span>
        <span class="n">use_ssl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">verify_certs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">is_aoss</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">engine</span><span class="o">=</span><span class="s">"faiss"</span><span class="p">,</span>
        <span class="n">space_type</span><span class="o">=</span><span class="s">"l2"</span><span class="p">,</span>
        <span class="n">bulk_size</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
        <span class="n">ssl_show_warn</span><span class="o">=</span><span class="bp">False</span>
    <span class="p">)</span>

<span class="n">vector_db</span><span class="p">.</span><span class="n">add_documents</span><span class="p">(</span>
        <span class="n">documents</span><span class="o">=</span><span class="n">docs</span><span class="p">,</span>
        <span class="n">vector_field</span><span class="o">=</span><span class="s">'vector_field'</span><span class="p">,</span>
        <span class="n">bulk_size</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></div>

<h3 id="retrievals">Retrievals</h3>
<p>Opensearchë¥¼ ì´ìš©í•  ìˆ˜ ìˆëŠ” Python ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ opensearchpyë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ lexical searchì™€ semantic searchë¥¼ êµ¬í˜„í•˜ê³  ì´ë¥¼ ì´ìš©í•´ hybrid searchë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">opensearchpy</span> <span class="kn">import</span> <span class="n">OpenSearch</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">OpenSearch</span><span class="p">(</span>
        <span class="n">hosts</span><span class="p">,</span>
        <span class="p">...</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">get_document</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">index_name</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_lexical_search</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">index_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"index_name"</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"query"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"match"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"text"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">"query"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'query'</span><span class="p">)</span><span class="si">}</span><span class="s">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s">"size"</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"k"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">get_document</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">index_name</span><span class="o">=</span><span class="n">index_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">def</span> <span class="nf">get_semantic_search</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">index_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"index_name"</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"query"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"knn"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"vector_field"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">"vector"</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"vector"</span><span class="p">),</span>
                    <span class="s">"k"</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"k"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">get_document</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">index_name</span><span class="o">=</span><span class="n">index_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></div>
<p>ê° search í•¨ìˆ˜ì˜ responseì—ëŠ” ë¬¸ì„œì™€ ìŠ¤ì½”ì–´ê°€ íŠœí”Œ í˜•íƒœë¡œ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ìŠ¤ì½”ì–´ë¥¼ normalizationí•˜ëŠ” í•¨ìˆ˜ì™€ CC í˜¹ì€ RRFë¥¼ ì ìš©í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì—¬ ìµœì¢… ë¬¸ì„œë¥¼ ë°˜í™˜í•˜ë„ë¡ í•©ë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">normalization</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">hits</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'hits'</span><span class="p">][</span><span class="s">'hits'</span><span class="p">]</span>
    <span class="n">max_score</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'hits'</span><span class="p">][</span><span class="s">'max_score'</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">hit</span> <span class="ow">in</span> <span class="n">hits</span><span class="p">:</span>
        <span class="n">hit</span><span class="p">[</span><span class="s">'_score'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">hit</span><span class="p">[</span><span class="s">'_score'</span><span class="p">])</span> <span class="o">/</span> <span class="n">max_score</span>
    <span class="n">response</span><span class="p">[</span><span class="s">'hits'</span><span class="p">][</span><span class="s">'max_score'</span><span class="p">]</span> <span class="o">=</span> <span class="n">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">'_score'</span><span class="p">]</span> <span class="c1"># 1.0
</span>    <span class="n">response</span><span class="p">[</span><span class="s">'hits'</span><span class="p">][</span><span class="s">'hits'</span><span class="p">]</span> <span class="o">=</span> <span class="n">hits</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">def</span> <span class="nf">get_ensemble_results</span><span class="p">(</span><span class="n">doc_lists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Document</span><span class="p">]],</span> <span class="n">weights</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
    <span class="c1"># Weighted RRF
</span>    <span class="c1"># ë™ì ì ì²˜ë¦¬ì— ê°€ì¤‘ì¹˜ë¥¼ ì£¼ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
</span>    <span class="n">documents</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> <span class="c1"># unique docs
</span>    <span class="n">content_to_document</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">doc_list</span> <span class="ow">in</span> <span class="n">doc_lists</span><span class="p">:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">doc_list</span><span class="p">:</span>
            <span class="n">documents</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">page_content</span><span class="p">)</span>
            <span class="n">content_to_document</span><span class="p">[</span><span class="n">content</span><span class="p">]</span> <span class="o">=</span> <span class="n">doc</span>
    
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="n">content</span><span class="p">:</span> <span class="p">.</span><span class="mi">0</span> <span class="k">for</span> <span class="n">content</span> <span class="ow">in</span> <span class="n">documents</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">doc_list</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">doc_lists</span><span class="p">,</span><span class="n">weights</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">rank</span><span class="p">,</span> <span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doc_list</span><span class="p">,</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">page_content</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">rank</span> <span class="o">+</span> <span class="n">c</span><span class="p">))</span>
            <span class="n">results</span><span class="p">[</span><span class="n">content</span><span class="p">]</span> <span class="o">+=</span> <span class="n">score</span>

    <span class="n">sorted_results</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="p">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">sorted_docs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">content_to_document</span><span class="p">[</span><span class="n">content</span><span class="p">],</span> <span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sorted_results</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">sorted_docs</span>
</code></pre></div></div>

<p>Rerankë¥¼ ìˆ˜í–‰í•  ë•ŒëŠ” opensearchpyì˜ REST APIë¥¼ ë”°ë¡œ í˜¸ì¶œí•˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">rerank_documents</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">retrievals</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Document</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]):</span>
    <span class="n">model_id</span> <span class="o">=</span> <span class="s">""</span> <span class="c1"># Opensearch Rerank Model id
</span>    <span class="n">text_docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span><span class="p">.</span><span class="n">page_content</span> <span class="k">for</span> <span class="n">doc</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">retrievals</span><span class="p">]</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"query_text"</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span>
        <span class="s">"text_docs"</span><span class="p">:</span> <span class="n">text_docs</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">transport</span><span class="p">.</span><span class="n">perform_request</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="s">"POST"</span><span class="p">,</span>
        <span class="n">url</span><span class="o">=</span><span class="sa">f</span><span class="s">"/_plugins/_ml/models/</span><span class="si">{</span><span class="n">model_id</span><span class="si">}</span><span class="s">/_predict"</span><span class="p">,</span>
        <span class="n">body</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">'inference_results'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></div>

<h3 id="question-answering">Question Answering</h3>
<p>QA ë‹¨ê³„ì—ì„œëŠ” Retrieverê°€ ê°€ì ¸ì˜¨ ë¬¸ì„œì™€ ìœ ì € ì§ˆë¬¸ì„ ë¬¶ì–´ í”„ë¡¬í”„íŠ¸ë¥¼ êµ¬ì„±í•˜ì—¬ ë‹µë³€ì„ ë°›ì•„ì˜¤ë©´ ë©ë‹ˆë‹¤. ChatGPTì²˜ëŸ¼ í•œê¸€ìì”© ë‚˜íƒ€ë‚˜ë„ë¡ í•˜ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ ì½”ë“œì²˜ëŸ¼ streamì„ ì‚¬ìš©í•˜ì—¬ generator í•¨ìˆ˜ë¡œ êµ¬ì„±í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">langchain.schema</span> <span class="kn">import</span> <span class="n">StrOutputParser</span>
<span class="kn">from</span> <span class="nn">langchain_core.prompts</span> <span class="kn">import</span> <span class="n">HumanMessagePromptTemplate</span><span class="p">,</span> <span class="n">SystemMessagePromptTemplate</span><span class="p">,</span> <span class="n">ChatPromptTemplate</span>
<span class="kn">from</span> <span class="nn">langchain_google_genai</span> <span class="kn">import</span> <span class="n">GoogleGenerativeAI</span>

<span class="k">def</span> <span class="nf">get_answer</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">instruction</span> <span class="o">=</span> <span class="s">''</span> <span class="c1"># system prompt
</span>    <span class="n">human_prompt</span> <span class="o">=</span> <span class="s">''</span> <span class="c1"># user prompt
</span>
    <span class="n">system_template</span> <span class="o">=</span> <span class="n">SystemMessagePromptTemplate</span><span class="p">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>
    <span class="n">human_template</span> <span class="o">=</span> <span class="n">HumanMessagePromptTemplate</span><span class="p">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">human_prompt</span><span class="p">)</span>

    <span class="n">prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="p">.</span><span class="n">from_messages</span><span class="p">([</span><span class="n">system_template</span><span class="p">,</span> <span class="n">human_template</span><span class="p">])</span>

    <span class="n">invoke_args</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># user promptì˜ f-string ìš”ì†Œê°€ ìˆë‹¤ë©´ í•´ë‹¹ ìœ„ì¹˜ì— ê°’ì„ ë„£ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤
</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="n">prompt</span> <span class="o">|</span> <span class="n">llm</span> <span class="o">|</span> <span class="n">StrOutputParser</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">chain</span><span class="p">.</span><span class="n">stream</span><span class="p">(</span><span class="n">invoke_args</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">chunk</span>
</code></pre></div></div>

<h3 id="rag-demo-app">RAG Demo app</h3>
<figure>
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQSh7E_2NEAHTrG_aoS179uxAcSg6a6iNY6n12wVtah-ds0?width=2836&amp;height=1474" data-lightbox="gallery">
        <img src="https://1drv.ms/i/c/502fd124b305ba80/IQSh7E_2NEAHTrG_aoS179uxAcSg6a6iNY6n12wVtah-ds0?width=2836&amp;height=1474" alt="03" style="max-width: 100%; height: auto;" />
    </a>
</figure>

<p>ì•„ë˜ ì´ë¯¸ì§€ì²˜ëŸ¼ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ëŠ” ê´€ë ¨ëœ ë‚´ìš©ì´ ì—†ë‹¤ëŠ” ë‹µë³€ì„ ë°›ê²Œ ë©ë‹ˆë‹¤.</p>
<figure style="text-align:center">
    <a href="https://1drv.ms/i/c/502fd124b305ba80/IQQhGcqbU2XHRrBUuD6G9GkTASpNdBZtf51dAeIeKLjCZIo?width=793&amp;height=1144" data-lightbox="gallery">
        <img src="https://1drv.ms/i/c/502fd124b305ba80/IQQhGcqbU2XHRrBUuD6G9GkTASpNdBZtf51dAeIeKLjCZIo?width=793&amp;height=1144" alt="04" style="max-width: 80%; height: auto;" />
    </a>
</figure>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://aws.amazon.com/ko/blogs/tech/korean-reranker-rag/">í•œêµ­ì–´ Rerankerë¥¼ í™œìš©í•œ ê²€ìƒ‰ ì¦ê°• ìƒì„±(RAG) ì„±ëŠ¥ ì˜¬ë¦¬ê¸°</a></li>
  <li><a href="https://www.elastic.co/search-labs/blog/hybrid-search-elasticsearch">hyrbrid-search-elasticsearch</a></li>
  <li><a href="https://medium.com/@nuatmochoi/%ED%95%98%EC%9D%B4%EB%B8%8C%EB%A6%AC%EB%93%9C-%EA%B2%80%EC%83%89-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-feat-ensembleretriever-knowledge-bases-for-amazon-bedrock-d6ef1a0daaf1">í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ êµ¬í˜„í•˜ê¸° (feat. EnsembleRetriever, Knowledge Bases for Amazon Bedrock)</a></li>
  <li><a href="https://heygeronimo.tistory.com/101">[ë…¼ë¬¸ì´í•´] Lost in the Middle: How Language Models Use Long Contexts</a></li>
</ul>
:ET