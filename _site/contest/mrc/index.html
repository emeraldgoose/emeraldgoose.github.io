<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>P2 MRC 대회 회고 - gooooooooooose</title>
<meta name="description" content="대회 목적 Open Domain에 해당하는 Wikipedia 문서를 불러와 Query에 답을 하는 Open Domain Question Answering(ODQA) 대회입니다. 저는 주어진 Query를 받고 Context내에서 답을 찾는 Reader 모델의 모델링을 맡았습니다.">


  <meta name="author" content="goooose">
  
  <meta property="article:author" content="goooose">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="gooooooooooose">
<meta property="og:title" content="P2 MRC 대회 회고">
<meta property="og:url" content="http://localhost:4000/contest/mrc/">


  <meta property="og:description" content="대회 목적 Open Domain에 해당하는 Wikipedia 문서를 불러와 Query에 답을 하는 Open Domain Question Answering(ODQA) 대회입니다. 저는 주어진 Query를 받고 Context내에서 답을 찾는 Reader 모델의 모델링을 맡았습니다.">







  <meta property="article:published_time" content="2021-11-15T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/contest/mrc/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "emeraldgoose",
      "url": "http://localhost:4000/"
    
  }
</script>


  <meta name="google-site-verification" content="googleb34ce5276ba6573e" />





  <meta name="naver-site-verification" content="naver93cdc79a5629ab3736d7cf8ff7b51d80">


<!-- end _includes/seo.html -->




<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
           
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/" itemprop="item"><span itemprop="name">Home</span></a>

          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#contest" itemprop="item"><span itemprop="name">Contest</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">P2 MRC 대회 회고</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/bio-photo.png" alt="goooose" itemprop="image" class="u-photo" width="110px" height="110px">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">goooose</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Interested in ML/DL, Data Engineering.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">South Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:smk6221@naver.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/emeraldgoose" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
          
            <li><a href="https://www.linkedin.com/in/minseong-kim-84428b231/" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://gooooooooooose.tistory.com/" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Problem Solving OJ (KOR)</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="P2 MRC 대회 회고">
    <meta itemprop="description" content="대회 목적Open Domain에 해당하는 Wikipedia 문서를 불러와 Query에 답을 하는 Open Domain Question Answering(ODQA) 대회입니다. 저는 주어진 Query를 받고 Context내에서 답을 찾는 Reader 모델의 모델링을 맡았습니다.">
    <meta itemprop="datePublished" content="2021-11-15T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">P2 MRC 대회 회고
</h1>
          
<!--
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  0 minute read
</p>
            devinlife comments :
                싱글 페이지(포스트)에 제목 밑에 Updated 시간 표기
                기존에는 read_time이 표기. read_time -> date 변경
-->
            <p class="page__date"><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated: <time datetime="2021-11-15T00:00:00+09:00">November 15, 2021</time></p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h2 id="대회-목적">대회 목적</h2>
<p>Open Domain에 해당하는 Wikipedia 문서를 불러와 Query에 답을 하는 Open Domain Question Answering(ODQA) 대회입니다. 저는 주어진 Query를 받고 Context내에서 답을 찾는 Reader 모델의 모델링을 맡았습니다.</p>

<h2 id="성능향상을-위한-실험">성능향상을 위한 실험</h2>
<h3 id="베이스라인">베이스라인</h3>

<p>기존 베이스라인 코드에서 Huggingface의 AutoModelForQuestionAnswering을 불러 학습 시킨 후 Sparse Embedding을 이용한 Retriever를 통해 얻은 문서에서 답을 찾는 구성이었습니다. 직접 klue/roberta-large모델을 불러 tuning 했을 때 Public LB 32를 기록했습니다.</p>

<h3 id="robertaforquestionanswering">RobertaForQuestionAnswering</h3>

<p>저는 NLP 모델 중에 성능이 꽤 좋은 Roberta 모델을 이용하기로 하고 Huggingface의 RobertaForQuestionAnswering 모델의 구성을 알아보았습니다.</p>

<p>모델의 구성은 Roberta모델 위에 Dense모델이 하나 올라간 형태를 가지고 있었고 이를 Fine tuning하면 Train set의 validation 기준 Exact Match(EM) 72 위로 넘지 못하고 66으로 떨어진 후 다시 올라가는 반복적인 현상이 일어났습니다.</p>

<p>하나의 Dense 레이어의 가중치 사이즈보다 학습해야 할 정보가 더 많다고 생각하게 되어 hidden layer의 수를 늘리는 방법을 사용했습니다.</p>

<h3 id="bilstm">BiLSTM</h3>

<p>가장 처음 시도한 방법인데 BiLSTM을 올리고 그 위에 Dense 레이어를 올려 roberta의 출력 sequence를 LSTM이 학습하도록 구성했습니다. Retriever가 1개의 문서를 가져왔을 때는 답을 어느정도 찾았지만 많은 문서를 찾고 concat했을 때는 답변에 해당하는 문장을 가져와버리는 문제가 있었습니다.</p>

<p>LSTM 레이어를 늘려보거나 Dense 레이어를 늘린 후에 fine tuning을 시도해도 RobertaForQuestionAnswering보다 낮은 성능을 보여주었습니다.</p>

<p>그래서 RNN 구조 대신 MLP를 올려 토큰 전체의 관계를 학습하는 쪽으로 구성했습니다.</p>

<h3 id="mlp">MLP</h3>

<p>Roberta와 Dense 레이어 사이에 여러개의 레이어를 두어 성능이 향상되는지 실험했습니다.</p>

<p>(1024, 1024)사이즈의 Dense 레이어를 1개에서 2개를 넣었을 때가 성능이 향상되었고 3개 이상 넣었을 때부터 오히려 성능이 떨어졌습니다. 여기서 Dense 레이어 2개를 넣고 Fine tuning하여 Public LB 57을 달성했습니다.</p>

<p>그러나 이 모델 역시 validation set에서 성능의 상승과 하락이 반복되는 현상이 보여 두 가지 가설을 만들고 실험했습니다.</p>
<ul>
  <li>learning rate가 너무 커서 optima에 수렴하지 못함 → learning rate를 줄이거나 epoch를 늘리는 방법을 사용</li>
  <li>hidden layer size가 아직도 작아 학습한 것들을 수용하지 못함 → hidden layer의 사이즈를 2배와 4배로 늘리는 방법을 사용</li>
</ul>

<p>learning rate를 줄이거나 epoch를 늘리는 방법을 사용하는 방법은 오히려 성능 하락을 불러왔습니다.</p>

<p>hidden layer size를 2배와 4배로 늘린 방법을 사용했을 때 성능이 향상되었지만 2배로 늘린 경우(EM 74)가 4배로 늘린 경우(EM 73)보다 성능이 좋았습니다. 2배로 늘린 모델을 최적화하여 Public LB 60을 달성했습니다.</p>

<h3 id="overfitting-방지">Overfitting 방지</h3>

<p>EM의 반복적인 상승과 하락때문에 Overfitting이 의심되어 이를 해결하기 위한 방법들을 찾고 적용해보았습니다.</p>

<p>데이터 양이 적기 때문에 유리한 Group Normalization, NLP에서 많이 사용하는 Layer Normalization을 적용해보고 Activation function으로 gelu를 적용했습니다.</p>

<p>Dropout까지 사용하여 결과를 비교했을 때 Dropout 0.2를 주었을 때 가장 성능이 좋았습니다.</p>

<h3 id="다른-모델">다른 모델</h3>

<p>Bert와 Electra를 백본으로 하여 MLP를 올렸을 때 모두 Validation 기준 57.08를 받았습니다.</p>

<p>Bert는 Klue/bert-base, Electra는 monologg/koElectra-base-v3-discriminator를 사용했습니다.</p>

<p>시간이 없어서 RobertaQA모델과 같이 hidden layer의 사이즈를 출력의 2배로 하여 같은 레이어를 쌓았습니다. 세 모델을 hard voting했을 때 Public LB 58.75를 기록했습니다.</p>

<p>voting할 때 가중치를 주었을 때도 같은 스코어를 기록했습니다.</p>

<h2 id="회고">회고</h2>
<p>이번 대회는 베이스라인부터 너무 어려웠습니다. 2위를 한 조는 첫 주부터 베이스라인을 뜯기 시작했는데 저는 2번째 주부터 뜯기 시작해서 베이스라인을 이해하는데 늦었습니다. 코드가 굉장히 복잡하게 얽혀있기 때문에 완전히 분리하는 데 오래걸렸습니다.</p>

<p>모델을 구성하는데 정말 다양한 오류를 발생했고 huggingface 코드로 들어가서 하나하나 print를 찍어볼 수 밖에 없었습니다. 많은 시간을 투자한 덕분에 huggingface의 모델 소스의 이해나 다양한 방법을 좀 더 쉽게 적용할 수 있었습니다.</p>

<p>초반에 Sparse Retriever의 성능을 확인하지 못하여 빠르게 Dense Retriever로 옮기지 못한 것도 아쉽습니다. Retriver가 좋지 않아 제출을 해도 비교가 어려울 정도였어서 validation 기준으로 비교했습니다. 그래도 빠르게 엘라스틱 서치를 적용하여 LB를 올리긴 했지만 많이 아쉬운 대회였습니다.</p>

<p>추가적으로 처음 Wandb sweep을 이용하여 fine tuning을 시도했었는데 굉장히 편해서 나중에도 사용할 것 같습니다.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#boostcamp" class="page__taxonomy-item p-category" rel="tag">boostcamp</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#contest" class="page__taxonomy-item p-category" rel="tag">Contest</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-11-15T00:00:00+09:00">November 15, 2021</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/boostcamp/re-data-exc/" class="pagination--pager" title="관계 추출 데이터 구축 실습
">Previous</a>
    
    
      <a href="/atcoder/abc227/" class="pagination--pager" title="KEYENCE Programming Contest 2021 (AtCoder Beginner Contest 227)
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/coursera/finetuning-LLMs/" rel="permalink">Finetuning Large Language Models 정리
</a>
      
    </h2>
    


    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> December 07 2023</p>
    
    <p class="archive__item-excerpt" itemprop="description">
  Finetuning Large Language Models - Deeplearning.ai

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/contest/ai-ctf/" rel="permalink">AI Village Capture the Flag @ DEFCON31 후기
</a>
      
    </h2>
    


    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> November 10 2023</p>
    
    <p class="archive__item-excerpt" itemprop="description">AI 관련 CTF가 있는 줄은 몰랐는데 Kaggle에서 해당 대회가 열려 한번 참가하여 한 달간 풀어봤습니다. 대회에서 사용되는 Capture the Flag(CTF) 방식은 취약점을 통해 주최자가 숨겨둔 플래그를 찾아 문제를 해결할 수 있습니다. 이 대회는 27개의 문제로 이루어...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/atcoder/abc317/" rel="permalink">GAMEFREAK Programming Contest 2023 (AtCoder Beginner Contest 317)
</a>
      
    </h2>
    


    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> August 29 2023</p>
    
    <p class="archive__item-excerpt" itemprop="description">A. Potions
현재 체력 H에서 $P_i$만큼 회복시킬 수 있는 포션을 먹을 때 체력이 X만큼 차면서 X에 가장 가까운 i를 찾는 문제이다.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/nlp/wordpiece-tokenizer/" rel="permalink">Wordpiece Tokenizer
</a>
      
    </h2>
    


    
      <p class="page__meta"><i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i> July 07 2023</p>
    
    <p class="archive__item-excerpt" itemprop="description">Reference

  Wordpiece 토크나이저는 BERT를 사전학습할때 사용했던 토크나이저입니다. BPE(Byte-Pair Encoding) 토크나이저와 방식은 거의 똑같은데 단어를 합치는 부분이 다른점이 특징입니다.

</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 emeraldgoose. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'emeraldgoose/emeraldgoose.github.io');
    script.setAttribute('issue-term', 'pathname');
    
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  




<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
  inlineMath: [['$','$']],
  displayMath: [['$$','$$']],
  processEscapes: true
  },
  "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

  </body>
</html>
